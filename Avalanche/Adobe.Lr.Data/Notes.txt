pulling all images and their collections and stuff

SELECT
	r.absolutePath,
	r.relativePathFromCatalog,
	l.pathFromRoot,
	f.idx_filename,
	SUM(CASE WHEN i.id_local IS NOT NULL THEN 1 ELSE 0 END),
	MAX(z.id_local),
	MAX(c.name),
	MAX(i.id_local)
FROM
	AgLibraryFile f
	INNER JOIN AgLibraryFolder l ON f.folder = l.id_local
	INNER JOIN AgLibraryRootFolder r ON l.rootFolder = r.id_local
	LEFT OUTER JOIN Adobe_images z ON f.id_local = z.rootFile
	LEFT OUTER JOIN AgLibraryCollectionImage i ON z.id_local = i.image
	LEFT OUTER JOIN AgLibraryCollection c ON i.collection = c.id_local
GROUP BY
	r.absolutePath,
	r.relativePathFromCatalog,
	l.pathFromRoot,
	f.idx_filename
ORDER BY
	CASE WHEN SUM(CASE WHEN i.id_local IS NOT NULL THEN 1 ELSE 0 END) > 0 THEN 1 ELSE 0 END DESC,
	MAX(c.name) ASC,
	f.idx_filename ASC